import{a as s,b as d}from"./chunk-J2EDIDWX.mjs";import{Tool as b}from"@goat-sdk/core";import{SolanaWalletClient as u}from"@goat-sdk/wallet-solana";import{Keypair as g,VersionedTransaction as h}from"@solana/web3.js";function y(p,e,n,a){var t=arguments.length,o=t<3?e:a===null?a=Object.getOwnPropertyDescriptor(e,n):a,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(p,e,n,a);else for(var r=p.length-1;r>=0;r--)(i=p[r])&&(o=(t<3?i(o):t>3?i(e,n,o):i(e,n))||o);return t>3&&o&&Object.defineProperty(e,n,o),o}s(y,"_ts_decorate");function c(p,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(p,e)}s(c,"_ts_metadata");var m=class{static{s(this,"PumpService")}async createAndBuyToken(e,n){let a=await this.createTokenMetadata({name:n.name,symbol:n.symbol,description:n.description,imageUrl:n.imageUrl}),t=g.generate(),o=await fetch("https://pumpportal.fun/api/trade-local",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({publicKey:e.getAddress(),action:"create",tokenMetadata:{name:a.metadata.name,symbol:a.metadata.symbol,uri:a.metadataUri},mint:t.publicKey.toBase58(),denominatedInSol:"true",amount:n.amountToBuyInSol,slippage:n.slippage,priorityFee:n.priorityFee,pool:"pump"})});if(o.status!==200)throw new Error(`Failed to create token: ${o.statusText}`);let i=await o.arrayBuffer(),r=h.deserialize(new Uint8Array(i)),f=await e.decompileVersionedTransactionToInstructions(r),{hash:l}=await e.sendTransaction({instructions:f,accountsToSign:[t]});return{hash:l,createdToken:t.publicKey.toBase58(),creator:e.getAddress(),url:`https://pump.fun/coin/${t.publicKey.toBase58()}`}}async createTokenMetadata(e){let n=await fetch(e.imageUrl).then(i=>i.blob()),a=new File([n],"image.png",{type:"image/png"}),t=new FormData;return t.append("file",a),t.append("name",e.name),t.append("symbol",e.symbol),t.append("description",e.description),t.append("showName","true"),e.twitter&&t.append("twitter",e.twitter),e.telegram&&t.append("telegram",e.telegram),e.website&&t.append("website",e.website),(await fetch("https://pump.fun/api/ipfs",{method:"POST",body:t})).json()}};y([b({description:"Create a token and buy it using pump.fun"}),c("design:type",Function),c("design:paramtypes",[typeof u>"u"?Object:u,typeof d>"u"?Object:d]),c("design:returntype",Promise)],m.prototype,"createAndBuyToken",null);export{m as a};
